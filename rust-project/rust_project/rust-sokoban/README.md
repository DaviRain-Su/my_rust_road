在本节中，我们将更详细地讨论 Sokoban 以及我们将如何构建我们的游戏。

下面是一个 Sokoban 游戏的样子，如果你还不熟悉的游戏玩法。我们有墙和盒子，我们的目标是让玩家把盒子推到他们的位置上。

ECS (实体组件系统)是一种遵循组合优于继承原则的编写游戏的体系结构模式。我们将在这个项目中大量使用 ECS，就像大多数 Rust 游戏一样，所以让我们花一点时间熟悉一下关键概念:

组件——只有数据的结构，它们具有实体的不同特征: 组件的一些示例: 位置、可渲染、移动等。这里的关键部分是，这是纯粹的数据，没有行为

实体-实体是由多个组成部分组成的，例如一个玩家可能由位置，渲染和移动组成，而地板可能只是位置和渲染，因为它不移动。实体很大程度上只是一个或多个带有唯一标识符的虚拟容器

系统-系统使用实体和组件，并包含基于该数据的行为和逻辑。例如，您可以有一个呈现系统，它只是遍历包含可呈现组件的所有实体，并绘制所有实体。这里的关键在于组件本身不包含任何行为，而是使用一个系统来解释数据并进行操作

如果这还没有意义，不要担心，我们将在下一节讨论一些应用于我们的 Sokoban 游戏的实际例子。

基于我们现在所知道的 Sokoban 游戏应该如何工作，我们将需要一些不同类型的“东西” : 墙壁，一个玩家，地板，盒子和盒子点。这些将是我们的实体。

现在我们必须确定这些实体将由什么组成，或者我们需要什么组件。首先，我们需要跟踪地图上所有东西的位置，所以我们需要某种位置组件。其次，一些(但不是全部)实体可以移动。玩家可以移动，但是如果被玩家推动，盒子也可以移动。最后，我们需要一种呈现每个实体的方法，因此我们需要一些可呈现的组件。

下面是我们第一个关于实体和组件的想法:

玩家实体: 位置，可渲染，可移动

墙体实体: 位置，渲染

地板实体: 位置，渲染

框实体: 位置，可渲染，可移动

盒点实体: 位置，渲染

刚开始在 ECS 中思考可能会很困难，所以如果您还不理解所有的东西，或者这与您在其他语言中完成事情的方式不熟悉，不要担心。

在本节中，我们将创建组件，我们将了解如何创建实体并注册所有内容以保持 specs 满意。

让我们从定义组件开始。我们之前讨论了位置，渲染和移动-我们现在跳过移动。我们还需要一些组件来识别每个实体——例如，我们需要一个 Wall 组件，这样我们就可以通过一个实体有一个 Wall 组件来识别它。

这应该是直接的，位置组件存储的 x，y 和 z 坐标，这将告诉我们在地图上的东西在哪里，和可渲染的组件将接收一个字符串路径指向一个图像，我们可以渲染。所有其他组件都是标记组件，没有数据。

在我们熟悉的 Rust 代码中，我们有了一些新的语法，我们使用了一个名为 procedure Macros 的强大的 Rust 特性，它用于 # [ storage (VecStorage)]。这些类型的宏实际上是在编译时消耗一些语法并产生一些新语法的函数。

为了让 specs 满意，我们必须提前告诉它我们将使用什么组件。让我们创建一个将组件注册到 specs 的函数。


实体只是绑定到一组组件的数字标识符。所以我们创建实体的方法就是简单地指定它们包含哪些组件。

最后，让我们把一切联系在一起。我们需要创建一个 specs: : World 对象，我们将它添加到我们的 Game struct 中，并在 main 中首先初始化它。这里是完整的代码，现在运行应该呈现相同的空白窗口，但我们已经取得了巨大的进展，在实际设置我们的游戏组件和实体！接下来，我们将开始渲染，所以我们终于可以在屏幕上看到一些东西

